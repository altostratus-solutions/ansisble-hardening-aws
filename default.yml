---

# run in "skipping" mode
- name: wrapper playbook for kitchen testing "ansible-os-hardening"
  hosts: localhost
  vars:
    deploy_security_rules: false
  roles:
    - ansible-os-hardening
    - { role: ansible-os-hardening, when: deploy_security_rules }

# run in check mode
- name: wrapper playbook for kitchen testing "ansible-os-hardening"
  hosts: localhost
  check_mode: true
  roles:
    - ansible-os-hardening

- name: wrapper playbook for kitchen testing "ansible-os-hardening" with custom vars for testing
  hosts: localhost
  roles:
    - ansible-os-hardening
  vars:
    os_security_users_allow: change_user
    os_security_kernel_enable_core_dump: false
    os_security_suid_sgid_remove_from_unknown: true
    os_auth_pam_passwdqc_enable: false
    os_desktop_enable: true
    os_env_extra_user_paths: ['/home']
    os_auth_allow_homeless: true
    os_security_suid_sgid_blacklist: ['/bin/umount']
    os_security_suid_sgid_whitelist: ['/usr/bin/rlogin']

- name: wrapper playbook for kitchen testing "ansible-os-hardening"
  hosts: localhost
  roles:
    - ansible-os-hardening

